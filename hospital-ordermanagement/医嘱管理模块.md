# 医嘱管理模块

## **一、医嘱管理模块用例图**

![image.png](%E5%8C%BB%E5%98%B1%E7%AE%A1%E7%90%86%E6%A8%A1%E5%9D%97%201c88ffd937e280ee9f47f7af2ff6b74c/image.png)

## **二、医嘱管理模块时序图**

![image.png](%E5%8C%BB%E5%98%B1%E7%AE%A1%E7%90%86%E6%A8%A1%E5%9D%97%201c88ffd937e280ee9f47f7af2ff6b74c/image%201.png)

## **三、医嘱管理模块类图**

![image.png](%E5%8C%BB%E5%98%B1%E7%AE%A1%E7%90%86%E6%A8%A1%E5%9D%97%201c88ffd937e280ee9f47f7af2ff6b74c/image%202.png)

## **四、医嘱管理模块数据库设计**

### **1. 患者信息表（`patient_info`）**

| **字段名** | **数据类型** | **约束** | **注释** |
| --- | --- | --- | --- |
| patient_id | INT | PRIMARY KEY | 患者 ID，自增 |
| name | VARCHAR(50) | NOT NULL | 姓名 |
| id_number | VARCHAR(18) | UNIQUE | 身份证号 |
| bed_number | VARCHAR(20) | NOT NULL  | 房间床位 |

### **2. 医生信息表（`doctor_info`）**

| **字段名** | **数据类型** | **约束** | **注释** |
| --- | --- | --- | --- |
| doctor_id | INT | PRIMARY KEY | 医生 ID，自增 |
| name | VARCHAR(50) | NOT NULL | 姓名 |
| department | VARCHAR(50) | NOT NULL | 所属科室 |

### **3. 医嘱主表（`medical_order_main`）**

| **字段名** | **数据类型** | **约束** | **注释** |
| --- | --- | --- | --- |
| order_id | VARCHAR(50) | PRIMARY KEY | 医嘱 ID（唯一标识） |
| patient_id | INT | FOREIGN KEY | 关联患者 ID |
| doctor_id | INT | FOREIGN KEY | 关联医生 ID |
| order_type | ENUM (' 临时 ', ' 长期 ') | NOT NULL | 医嘱类型 |
| content | TEXT | NOT NULL | 医嘱内容 |
| dosage | VARCHAR(50) | - | 单次剂量 |
| usage | VARCHAR(50) | - | 用法（如口服、静脉滴注） |
| frequency | VARCHAR(50) | - | 频次（如每天 3 次） |
| send_time | DATETIME | DEFAULT CURRENT_TIMESTAMP | 发送时间 |
| status | ENUM (' 待校对 ', ' 已校对 ', ' 已执行 ', ' 已作废 ') | NOT NULL | 状态 |
| start_time | DATETIME | NOT NULL | 开始时间 |

### **4. 临时医嘱表（`temporary_order`）**

| **字段名** | **数据类型** | **约束** | **注释** |
| --- | --- | --- | --- |
| order_id | VARCHAR(50) | PRIMARY KEY | 关联医嘱主表 ID |
| validity_period | VARCHAR(50) | - | 有效期（如 “24 小时内”） |

### **5. 长期医嘱表（`long_term_order`）**

| **字段名** | **数据类型** | **约束** | **注释** |
| --- | --- | --- | --- |
| order_id | VARCHAR(50) | PRIMARY KEY | 关联医嘱主表 ID |
| stop_time | DATETIME | - | 停止时间 |

### **6. 医嘱操作记录（`order_operation_log`）**

| **字段名** | **数据类型** | **约束** | **注释** |
| --- | --- | --- | --- |
| log_id | INT | PRIMARY KEY | 记录 ID，自增 |
| order_id | VARCHAR(50) | FOREIGN KEY | 关联医嘱 ID |
| operation_type | VARCHAR(20) | NOT NULL | 操作类型（作废、校对等） |
| operation_time | DATETIME | DEFAULT CURRENT_TIMESTAMP | 操作时间 |
| operator_id | INT | - | 操作人 ID（医生 / 护士） |

## **五、医嘱管理模块api接口设计**

### **1. 医嘱列表查询接口**

**功能**：获取临时 / 长期医嘱列表，支持状态筛选与分页

**接口地址**：`/api/medical-order/list`

**请求方法**：GET

**请求参数**：

| **参数名** | **类型** | **是否必填** | **说明** |
| --- | --- | --- | --- |
| orderType | string | 否 | 医嘱类型（临时/长期） |
| status | string | 否 | 状态（待校对/已校对/已执行/已作废） |
| patientName | string | 否 | 患者姓名模糊查询 |
| page | int | 是 | 页码 |
| pageSize | int | 是 | 每页数量 |

**响应示例**：

```json
{  
  "code": 200,  
  "message": "成功",  
  "data": {  
    "total": 50,  
    "list": [  
      {  
        "orderId": "ORDER_001",  
        "patientName": "李大爷",  
        "orderType": "临时",  
        "content": "阿莫西林胶囊",  
        "status": "待校对",  
        "sendTime": "2024-05-12 09:10:00"  
      }  
    ]  
  }  
}
```

### **2. 新增医嘱接口**

**功能**：创建临时或长期医嘱

**接口地址**：`/api/medical-order/create`

**请求方法**：POST

**请求参数**：

| **参数名** | **类型** | **是否必填** | **说明** |
| --- | --- | --- | --- |
| patientId | int | 是 | 患者 ID |
| doctorId | int | 是 | 医生 ID |
| orderType | string | 是 | 医嘱类型（`临时`/`长期`） |
| content | string | 是 | 医嘱内容 |
| dosage | string | 否 | 单次剂量 |
| usage | string | 否 | 用法（如`口服(po)`） |
| frequency | string | 否 | 频次（如`每天3次(td)`） |
| validityPeriod | string | 否 | 临时医嘱有效期（仅临时医嘱） |
| stopTime | string | 否 | 长期医嘱停止时间（仅长期医嘱，格式：YYYY-MM-DD HH:MM:SS） |

**响应示例**：

```json
{  
  "code": 200,  
  "message": "医嘱创建成功",  
  "data": {  
    "orderId": "ORDER_002"  
  }  
}
```

### **3. 医嘱详情查询接口**

**功能**：根据医嘱 ID 获取详细信息

**接口地址**：`/api/medical-order/detail`

**请求方法**：GET

**请求参数**：

| **参数名** | **类型** | **是否必填** | **说明** |
| --- | --- | --- | --- |
| orderId | string | 是 | 医嘱 ID |

**响应示例**（长期医嘱）：

```json
{  
  "code": 200,  
  "message": "成功",  
  "data": {  
    "orderId": "ORDER_001",  
    "patientName": "李大爷",  
    "doctorName": "王医生",  
    "orderType": "长期",  
    "content": "0.9%葡萄糖注射液",  
    "dosage": "500ml",  
    "usage": "静脉滴注(ivdrip)",  
    "frequency": "每天1次(qd)",  
    "stopTime": "2024-07-14 09:10:00",  
    "status": "已校对"  
  }  
}
```

### **4. 修改医嘱接口**

**功能**：更新医嘱内容（需校验状态是否允许修改）

**接口地址**：`/api/medical-order/update`

**请求方法**：PUT

**请求参数**：

| **参数名** | **类型** | **是否必填** | **说明** |
| --- | --- | --- | --- |
| orderId | string | 是 | 医嘱 ID |
| content | string | 否 | 医嘱内容（更新部分） |
| dosage | string | 否 | 单次剂量（更新部分） |
| usage | string | 否 | 用法（更新部分） |
| frequency | string | 否 | 频次（更新部分） |

**响应示例**：

```json
{  
  "code": 200,  
  "message": "医嘱修改成功"  
}
```

### **5. 作废医嘱接口**

**功能**：标记医嘱为作废状态

**接口地址**：`/api/medical-order/void`

**请求方法**：DELETE

**请求参数**：

| **参数名** | **类型** | **是否必填** | **说明** |
| --- | --- | --- | --- |
| orderId | string | 是 | 医嘱 ID |

**响应示例**：

```json
{  
  "code": 200,  
  "message": "医嘱作废成功"  
}
```

### **6. 打印医嘱接口**

**功能**：支持单个或批量打印医嘱

**接口地址**：`/api/medical-order/print`

**请求方法**：GET

**请求参数**：

| **参数名** | **类型** | **是否必填** | **说明** |
| --- | --- | --- | --- |
| orderIds | string | 是 | 医嘱 ID（多个用逗号分隔，如 `ORDER_001,ORDER_002`） |

**响应示例**：

```json
{  
  "code": 200,  
  "message": "医嘱打印任务已发起"  
}
```